

     Для "перекачки" информации из ПР-90 необходимо соединить кабелем
 ПР-90 с СОМ1 на IBM PC. Запустить программу  ОБМЕН из отдельного модуля ПР-90
 дождаться появления надписи   ЖДУ АД  на экране ПР-90 и запустить программу
 obmen.exe,obmen1 на РС. По запросу программы  obmen.exe сообщить имя файла 
куда будет записана информация с ПР-90. Пrи обмене чеез СОМ2 запустить
пrогамму obmen2.exe.


    Для работы с программой graf200.exe необходимо предварительно сделать
 следующее:

    1.  С помощью программы  obmen*.exe  осуществить обмен информацией между
      ПР-90 и IBM PC. Считанная информация, после работы программы obmen.exe,
      будут записана в файл. ( Напrимеr  pp).

    2. Программа распаковки файлов для прибора ПР-90  rf200.exe  осуществляет
      обработку  файла  ( pp )  и  создает  N  файлов  типа   *.grf, где
      N - количество записей в обрабатываемом файле (На  поставляемой дискете
      в  качестве  примера результата работы программы  rf200.exe  c  файлом
      pp  записаны файлы  p1.spe .. p3.spe).Если на запрос имени создаваемого
      файла нажать "Enter" распаковки данной записи не происходит.

    Программа graf200.exe работает с файлами типа  *.grf. После запуска программы
  в нижней части экрана представленно функциональное меню. Управление работой
  программы осуществляется нажатием клавиш указанных в функциональном меню.

                     Работа ПР в режиме ОБМЕН

       После запуска режима "ОБМЕН" ПР выполняет следующие действия:

     1) Выдает на экран надпись ЖДУ AD

     2) Ожидает следующей последовательности байт

         'A', 'D', NAD , NAD , KNAD

           NAD          - младший байт слова

           NAD          - старший байт слова

           KNAD         - (NAD  + NAD ) mod 256

           NAD (слово)  - начальный адрес долговременной памяти, начиная

                      с которого будет передаваться информация по RS-232.

     3) Получив от PC посылку по пункту 2, ПР передает последовательность

        байт 0, 0, 'S', 'T', 'R', 'T', X.
        X - произвольный байт. Далее передает 1024  байт из долговремен-

        ной памяти, начиная с адреса 2*NAD.

     4) Переходит к пункту 1.

      Задавая от PC NAD можно скопировать в PC всю информацию из ПР.

              СТРУКТУРА ПАМЯТИ ДОЛГОВРЕМЕННОГО ХРАНЕНИЯ
    v 1.8 (неверно, это для версии ПР90.59М, отличаются S44 и S46)
               Условные обозначения
         B - байт, S -слово(2 байта).
         Число следующее за символами B или S является адресом
         байта или слова соответственно.

                  Структура первого Кбайта памяти
                       /адреса абсолютные/
      S4  -  (количество записей+1);
      S64 -  (адрес первой записи/2);
             первая запись начинается с адреса 1024, следовательно
             в S64 записано число 512;
      S66 -  (адрес второй  записи/2);
      S68 -  (адрес третьей записи/2);
                   итд.

                  Структура записи
      /адреса относительные (первый байт записи имеет адрес 0)/
      B0..B7 -  имя;
      B8,B9  -  нулевые байты;
      B10..B11 - режим  =
                'al'- прямой сигнал, линейный вход;
                'az'- прямой сигнал, вход усилителя заряда;
                'ol'- огибающая сигнала, линейный вход;
                'oz'- огибающая сигнала, вход усилителя заряда;
                'dn'- сигнал + импульсы от датчика(в разряде D0);
                'ts'- тестовый сигнал;
      S12 - код коэффициента усиления переключаемого усилителя =
                восмеричные
                  40    - усиление   -6 дБ
                  20    - усиление    0 дБ
                  10    - усиление    6 дБ
                 120    - усиление   12 дБ
                 110    - усиление   18 дБ
                 104    - усиление   24 дБ
                 102    - усиление   30 дБ
                 101    - усиление   36 дБ
      S14 - верхняя частота рабочего диапазона ( Гц);
      S16 - код средней частоты при работе с огибающей = десятичные
                  0  при средней частоте 3.1 кГц
                192  при средней частоте 6.3 кГц
                128  при средней частоте   8 кГц
                 64  при средней частоте  10 кГц;
      S18 - размерность БПФ;
      S20 - количество усреднений в данной записи;
      B22 - байт контроля Хеннинг/прямоугольник
                D7=0 временное окно прямоугольник
                D7=1 временное окно Хеннинга;
      B23 - байт контроля скорость/ускорение
            при вводе через усилитель заряда и идикации спектра
                D7=0 информация в единицах ускорения( м/с2)
                D7=1 информация в единицах скорости ( м/с);
                При вводе по линейному входу информация в mV;
      S24 - KOFLN (коэффициент);
      S26 -  служ. слово (используется только программой прибора);
      S28 - KDBCH (коэффициент);
      B30 - байт контроля типа записи
                D7=0 записан сигнал
                D7=1 записан спектр;
      B31 - байт контроля логарифм/линейный
                D7=0 масштаб по оси У линейный
                D7=1 масштаб по оси У логарифмический;
      S32 -  служ. слово (используется только программой прибора);
      S34 - KDBLN (коэффициент);
      S36 - количество отсчетов информации в записи(сигнала или спектра);
      S38 - MNOJ  (коэффициент);
      S40 - MNOJ1 (коэффициент);
      S42 - служ. слово (используется только программой прибора);
      S44 - DC6 - индикатор положения переключателя -24 дБ,
                D6 = 1   - усилитель заряда без ослабления
		D6 = 0   - в усилитель заряда введено ослабление 24дБ;  
      S46 - KOFCH (коэффициент);
      B48.....   отсчеты сигнала или спектра;
            Обозначим Х - значение байта(целое без знака 0..255),
                      Y - фактическое значение отсчета, вычисляется
                      по следующей формуле

                      Y = A * ( X + B)

      Коэффициенты  А  и  В  вычисляются по следующему алгоритму:
           Z = MNOJ1        если записан сигнал;
           Z = MNOJ1 + MNOJ если записан спектр;
           Т = KDBCH        если вход усилителя заряда;
           T = KDBLN        если линейный вход;
           B = -128         если записан сигнал;
           B = 0            если записан спектр и масштаб линейный;
           В = 4 * Z + T+14 если записан спектр и масштаб логарифмический;
           А = 0.25         если масштаб логарифмический;
                     если масштаб линейный
           А = (7500 / KOFCH) * EXP2(Z/6) - при входе усилителя заряда;
           А = (7500 / KOFLN) * EXP2(Z/6) - при линейном входе;
                    EXP2  - експонента по основанию 2.

